<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Stalk Instagram</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">

  <!-- Placeholder Komponen -->
  <div id="navbar-placeholder"></div>

  <div class="flex min-h-screen">
    <div id="sidebar-placeholder"></div>

    <!-- Main Content -->
    <main class="flex-1 p-6">
      <h2 class="text-2xl font-bold mb-4 text-gray-800">Stalk Instagram</h2>
      <p class="mb-2 text-gray-600">Silakan masukkan username Instagram:</p>

      <form id="form" class="space-y-4">
        <input type="text" id="username" placeholder="cth: aldiansyahptra0"
               class="p-2 border border-gray-300 rounded w-full max-w-sm" required>
        <button type="submit" class="bg-pink-600 hover:bg-pink-700 text-white py-2 px-4 rounded">
          Cari Sekarang
        </button>
      </form>

      <div id="result" class="mt-6"></div>
    </main>
  </div>

  <script>
    // Load navbar & sidebar
    async function loadComponent(id, file) {
      const res = await fetch(file);
      const html = await res.text();
      document.getElementById(id).innerHTML = html;
    }

    loadComponent('navbar-placeholder', 'navbar.html');
    loadComponent('sidebar-placeholder', 'sidebar.html');

    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('hidden');
    }

    // Fungsi untuk ambil data dari API
    document.getElementById('form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const username = document.getElementById('username').value;
      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = 'üîÑ Mengambil data...';

      try {
        const res = await fetch('https://aquilaresbot.my.id/stalk/ig', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            username: username,
            apikey: 'Aldii'
          })
        });
        const data = await res.json();

        if (!data.success) throw new Error(data.message);

        const ig = data.data;
        resultDiv.innerHTML = `
          <div class="p-4 bg-white shadow rounded">
            <img src="${ig.linkpp || '#'}" alt="PP" class="w-24 h-24 rounded-full object-cover mb-3">
            <p><strong>Username:</strong> ${ig.nama}</p>
            <p><strong>Bio:</strong> ${ig.bio}</p>
            <p><strong>Postingan:</strong> ${ig.totalpost}</p>
            <p><strong>Followers:</strong> ${ig.totalpengikut}</p>
          </div>
        `;
      } catch (err) {
        resultDiv.innerHTML = `<p class="text-red-600">‚ùå ${err.message}</p>`;
      }
    });
  </script>

</body>
</html>
